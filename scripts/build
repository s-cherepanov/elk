. ../config/system
. ../config/site

if [ _$load_obj = _ ]; then
    load_obj=none
fi

echo Building Makefile.local...
cat <<EOT >Makefile.local
# This Makefile was produced by running ./build in this directory.

SHELL=/bin/sh

FILES= linkscheme makedl ldflags

all:      \$(FILES)

localize: \$(FILES)

linkscheme:	src/linkscheme ../config/system ../config/site
	\$(SHELL) src/\$@ > \$@
	chmod +x \$@

makedl:		src/makedl-$load_obj ../config/system ../config/site
	\$(SHELL) src/makedl-$load_obj > \$@
	chmod +x \$@

ldflags:	src/ldflags ../config/system ../config/site
	\$(SHELL) src/\$@ > \$@
	chmod +x \$@

install: \$(FILES)
	-@if [ ! -d $install_dir/bin ]; then \\
	    echo mkdir $install_dir/bin; \\
	    mkdir $install_dir/bin; \\
	fi
	cp linkscheme $install_dir/bin
	cp makedl $install_dir/bin
	-@if [ ! -d $install_dir/lib/elk ]; then \\
	    echo mkdir $install_dir/lib/elk; \\
	    mkdir -p $install_dir/lib/elk; \\
	fi
	cp ldflags $install_dir/lib/elk

distclean:
	rm -f \$(FILES) Makefile.local
EOT
